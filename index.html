<html>

<head>
    <title>INFO 3300 - Project 1</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <style>
        body, html {
            margin: 0;
            padding: 0;
        }

        .gridlines line {
            stroke: #bbb;
        }
    
        .gridlines .domain {
            stroke: none;
        }

        .header {
            background-color:rgb(255, 0, 0, 0.8);
            /* #FF0000; */
            height: 5rem;
        }

        .title {
            font-size: 2.5rem;
            color: white;
            text-align: center;
            padding-top: 1rem;
        }

        .sub_title {
            font-size: 2rem;
            text-align: center;
            color: #282828;
        }

        .logo {
            width: 9rem;
        }

        .para {
            background-color:rgb(255, 0, 0, 0.8);
            margin-left: 9%;
            margin-right: 9%;
            margin-top: 2%;
            margin-bottom: 2%;
            padding: 1.5%;
            font-size: 1.5rem;
            color: white;
            border-radius: 20px;
        }

        .svg {
            margin-left: 15%;
        }
    </style>
</head>

<body>
    <div class="project1">
        <div class="header">
            <h1 class="title">Project 1</h1>
        </div>
        <div class="sub_header">
            <h2 class="sub_title">What makes a video trending on <img class="logo" src="./YouTube_Logo.svg" />?</h2>
        </div>
    <p id="part1">
        <div class="para">In publishing and graphic design, Lorem ipsum is a placeholder text commonly used to demonstrate the visual form of a
        document or a typeface without relying on meaningful content. Lorem ipsum may be used before final copy is available,
        but it may also be used to temporarily replace copy in a process called greeking, which allows designers to consider
        form without the meaning of the text influencing the design.</div>
        <script>
            let result = [];
            d3.json("./most_popular_youtube_videos_usa_page1.json", d3.autoType)
                .then((data1) => {

                    result = result.concat(data1.items);

                    d3.json("./most_popular_youtube_videos_usa_page2.json", d3.autoType)
                        .then((data2) => {

                            result = result.concat(data2.items);
                            
                            d3.json("./most_popular_youtube_videos_usa_page3.json", d3.autoType)
                                .then((data3) => {

                                    result = result.concat(data3.items);
                                    
                                    d3.json("./most_popular_youtube_videos_usa_page4.json", d3.autoType)
                                        .then((data4) => {
    
                                            const width = 800;
                                            const height = 800;
                                            const svg = d3.select("#part1").append("svg")
                                                .attr("class", "svg")
                                                .attr("width", width)
                                                .attr("height", height);

                                            result = result.concat(data4.items);
                                            console.log("combined result", result);

                                            const xScale = d3.scaleBand()
                                                .domain([1, 2, 10, 17, 19, 20, 22, 23, 24, 25, 26, 27, 28, 29])
                                                .range([40, width-20])
                                                .padding(0.1);

                                            const yScale = d3.scaleLinear()
                                                .domain([0, 50])
                                                .range([height-20, 20]);

                                            // do stuff/explore
                                            // In final version, will concat data into a single file rather than doing it here

                                            const categories = {};
                                            result.forEach(d => {
                                                category = d.snippet.categoryId;
                                                if(categories[category]) {
                                                    categories[category] += 1;
                                                } else {
                                                    categories[category] = 1;
                                                }
                                            });
                                            console.log(categories);

                                            const categoryScale = d3.scaleOrdinal(d3.schemeCategory10);

                                            let leftAxis = d3.axisLeft(yScale);
                                            svg.append("g")
                                                .attr("class", "y axis")
                                                .attr("transform", "translate(20, 0)")
                                                .call(leftAxis);

                                            let bottomAxis = d3.axisBottom(xScale)
                                                .ticks(3)
                                                .tickSize(0);
                                            svg.append("g")
                                                .attr("class", "x axis")
                                                .attr("transform", "translate(-20, 780)")
                                                .call(bottomAxis);

                                            let leftGridlines = d3.axisLeft(yScale)
                                                .tickSize(-width + 40)
                                                .tickFormat("");
                                            svg.append("g").attr("class", "y gridlines")
                                                .attr("transform", "translate(20, 0)")
                                                .call(leftGridlines);

                                            Object.keys(categories).forEach( (key, i) => {
                                                console.log(key, categories[key]);

                                                svg.append("line")
                                                    .attr("x1", xScale(key))
                                                    .attr("x2", xScale(key))
                                                    .attr("y1", height-20)
                                                    .attr("y2", yScale(categories[key]))
                                                    .style("stroke", categoryScale(key))
                                                    .style("stroke-width", 35);
                                            });
                                            console.log(categoryScale.domain());

                                            // Add more code below

                                        }, (error) => {
                                            console.log(error);
                                            return;
                                        });

                                }, (error) => {
                                    console.log(error);
                                    return;
                                });

                        }, (error) => {
                            console.log(error);
                            return;
                        });

                }, (error) => {
                    console.log(error);
                });

        </script>

    </p>
</body>

</html>